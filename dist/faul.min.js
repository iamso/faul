/*!
 * faul - version 0.1.0
 *
 * Made with ‚ù§ by Steve Ottoz so@dev.so
 *
 * Copyright (c) 2017 Steve Ottoz
 */
(function(a,b){if('function'==typeof define&&define.amd)define(['module','exports'],b);else if('undefined'!=typeof exports)b(module,exports);else{var c={exports:{}};b(c,c.exports),a.Faul=c.exports}})(this,function(a,b){'use strict';function c(g,h){if(!(g instanceof h))throw new TypeError('Cannot call a class as a function')}Object.defineProperty(b,'__esModule',{value:!0});var d=function(){function g(h,j){for(var k=0;k<j.length;k++){var l=j[k];l.enumerable=l.enumerable,l.configurable=!0,'value'in l&&(l.writable=!0),Object.defineProperty(h,l.key,l)}}return function(h,j,k){return j&&g(h.prototype,j),k&&g(h,k),h}}(),f=function(){function g(){var h=0>=arguments.length||void 0===arguments[0]?{}:arguments[0],j=h.items,k=void 0===j?'.faul':j,l=h.bg,m=void 0!==l&&l,n=h.threshold,o=void 0===n?0:n,p=h.stagger,q=void 0===p?100:p,r=h.fn,s=void 0===r?function(t){}:r;c(this,g),this.hires=1<window.devicePixelRatio,this.attr=this.hires?'srcHires':'src',this.bg=m,this.th=o,this.stagger=q,this.fn=s,this.set(k),this.init()}return d(g,[{key:'init',value:function(){this.handler=this.load.bind(this),this.load(),window.addEventListener('scroll',this.handler),window.addEventListener('resize',this.handler)}},{key:'set',value:function(j){this.items=[].slice.call(j instanceof NodeList?j:document.querySelectorAll(j),0)}},{key:'load',value:function(j){var k=this;this.items=this.items.filter(function(l,m,n){var o=window.pageYOffset,p=o+window.innerHeight,q=Math.round(l.getBoundingClientRect().top+o),r=Math.round(q+l.clientHeight),s=r>o-k.th&&q<p+k.th;return s&&function(){var t=l.dataset[k.attr];if(t=t||l.dataset.src,t)if(l.style.transitionDelay=m*k.stagger+'ms',k.bg){var u=new Image;u.onload=function(v){l.style.backgroundImage='url('+t+')',l.classList.add('loaded'),k.fn(l)},u.src=t}else l.onload=function(v){l.classList.add('loaded'),k.fn(l)},l.src=t}(),!s})}},{key:'destroy',value:function(){window.removeEventListener('scroll',this.handler),window.removeEventListener('resize',this.handler)}}]),g}();b.default=f,a.exports=b['default']});